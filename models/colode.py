"""
Ð¤Ð°Ð¹Ð», Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°ÑŽÑ‰Ð¸Ð¹ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ blackjack
"""

from random import choice

# ÐšÐ¾Ð»Ð¾Ð´Ð° Ð½Ð° 52 ÐºÐ°Ñ€Ñ‚Ñ‹
c = {
    1: '2â¤ï¸',
    2: '2â™¦ï¸',
    3: '2â™ ',
    4: '2â™£',
    5: '3â¤ï¸',
    6: '3â™¦ï¸',
    7: '3â™ ',
    8: '3â™£',
    9: '4â¤ï¸',
    10: '4â™¦ï¸',
    11: '4â™ ',
    12: '4â™£',
    13: '5â¤ï¸',
    14: '5â™¦ï¸',
    15: '5â™ ',
    16: '5â™£',
    17: '6â¤ï¸',
    18: '6â™¦ï¸',
    19: '6â™ ',
    20: '6â™£',
    21: '7â¤ï¸',
    22: '7â™¦ï¸',
    23: '7â™ ',
    24: '7â™£',
    25: '8â¤ï¸',
    26: '8â™¦ï¸',
    27: '8â™ ',
    28: '8â™£',
    29: '9â¤ï¸',
    30: '9â™¦ï¸',
    31: '9â™ ',
    32: '9â™£',
    33: '10â¤ï¸',
    34: '10â™¦ï¸',
    35: '10â™ ',
    36: '10â™£',
    37: 'Jâ¤ï¸',
    38: 'Jâ™¦ï¸',
    39: 'Jâ™ ',
    40: 'Jâ™£',
    41: 'Qâ¤ï¸',
    42: 'Qâ™¦ï¸',
    43: 'Qâ™ ',
    44: 'Qâ™£',
    45: 'Kâ¤ï¸',
    46: 'Kâ™¦ï¸',
    47: 'Kâ™ ',
    48: 'Kâ™£',
    49: 'Tâ¤ï¸',
    50: 'Tâ™¦ï¸',
    51: 'Tâ™ ',
    52: 'Tâ™£',
}


# ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾Ñ‡ÐºÐ¾Ð², ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ðµ Ð´Ð°Ñ‘Ñ‚ ÐºÐ°Ñ€Ñ‚Ð° Ð¸Ð· c, ÑÐ¾Ð¿Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ 1 Ðº 1
points = {
    1 : 2,
    2 : 2,
    3 : 2,
    4 : 2,
    5 : 3,
    6 : 3,
    7 : 3,
    8 : 3,
    9 : 4,
    10 : 4,
    11 : 4,
    12 : 4,
    13 : 5,
    14 : 5,
    15 : 5,
    16 : 5,
    17 : 6,
    18 : 6,
    19 : 6,
    20 : 6,
    21 : 7,
    22 : 7,
    23 : 7,
    24 : 7,
    25 : 8,
    26 : 8,
    27 : 8,
    28 : 8,
    29 : 9,
    30 : 9,
    31 : 9,
    32 : 9,
    33 : 10,
    34 : 10,
    35 : 10,
    36 : 10,
    37 : 10,
    38 : 10,
    39 : 10,
    40 : 10,
    41 : 10,
    42 : 10,
    43 : 10,
    44 : 10,
    45 : 10,
    46 : 10,
    47 : 10,
    48 : 10,
    49 : 11,
    50 : 11,
    51 : 11,
    52 : 11,
}

# Ð”Ð»Ñ Ð¸Ð³Ñ€Ñ‹ Ð² blackjack Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ 6 ÐºÐ¾Ð»Ð¾Ð´, ÑÑ‚Ð¾ Ð¿Ð°Ñ‡ÐºÐ°
col = [i for i in range(1, 53)] * 6

emomoji = {
    1 : "1ï¸âƒ£",
    2 : "2ï¸âƒ£",
    3 : "3ï¸âƒ£",
    4 : "4ï¸âƒ£",
    5 : "5ï¸âƒ£",
    6 : "6ï¸âƒ£"
}

class Player():
    """
    ÐšÐ»Ð°ÑÑ Ð¸Ð³Ñ€Ð¾ÐºÐ°, ÑÐ¾Ð·Ð´Ð°Ñ‘Ñ‚ÑÑ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ blackjack
    Ð¸ Ð¿Ñ€ÐµÐ´Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½ Ð´Ð»Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð² Ñ€Ð°Ð¼ÐºÐ°Ñ… 1-Ð¹ Ñ€Ð°Ð·Ð´Ð°Ñ‡Ð¸
    """
    def __init__(self, name: str, bet: int, money: int, id: int) -> None:
        """
        ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
            name: str - Ð¸Ð¼Ñ Ð¸Ð³Ñ€Ð¾ÐºÐ°
            bet: int - ÑÑ‚Ð°Ð²ÐºÐ° Ð¸Ð³Ñ€Ð¾ÐºÐ°
            money: int - ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð´ÐµÐ½ÐµÐ³ Ð¸Ð³Ñ€Ð¾ÐºÐ°
            id: int - Ð°Ð¹Ð´Ð¸ Ð¸Ð³Ñ€Ð¾ÐºÐ° (Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ)
        """
        self.name = name
        self.bet = bet
        # Ð”ÐµÐ»Ð°Ð» Ð»Ð¸ Ð¸Ð³Ñ€Ð¾Ðº ÑÐ¿Ð»Ð¸Ñ‚
        self.split = False
        self.cards = 9999999999
        self.money = money
        # Ð—Ð°Ð²ÐµÑ€ÑˆÐ¸Ð» Ð»Ð¸ Ð¸Ð³Ñ€Ð¾Ðº ÑÐ²Ð¾Ð¹ Ñ…Ð¾Ð´
        self.end = False
        # ÐšÐ°Ñ€Ñ‚Ñ‹ Ð² Ñ€ÑƒÐºÐµ Ð¸Ð³Ñ€Ð¾ÐºÐ°
        self.hand = []
        self.id = id
        # Ð¡Ð´Ð°Ð»ÑÑ Ð»Ð¸ Ð¸Ð³Ñ€Ð¾Ðº
        self.surrender = False
    
    def __str__(self) -> str:
        return f"name: {self.name}; bet: {self.bet}; split: {self.split}; cards: {self.cards}; money: {self.money}; end: {self.end}; hand: {self.hand}; surrender: {self.surrender}"

    def __repr__(self) -> str:
        return self.__str__()
    
    def from_dict(self, inf):
        """
        ÐœÐµÑ‚Ð¾Ð´, ÑÐ¾Ð·Ð´Ð°ÑŽÑ‰Ð¸Ð¹ Ð¾Ð±ÑŠÐµÐºÑ‚ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð¸Ð· ÑÐ»Ð¾Ð²Ð°Ñ€Ñ
        """
        a = Player(inf['name'], inf['bet'], inf['money'], inf['id'])
        a.split = inf['split']
        a.cards = inf['cards']
        a.end = inf['end']
        a.hand = inf['hand']
        a.id = inf['id']
        a.surrender = inf['surrender']
        return a
    
    def sm(self):
        """
        ÐœÐµÑ‚Ð¾Ð´, ÑÑ‡Ð¸Ñ‚Ð°ÑŽÑ‰Ð¸Ð¹ ÑÑƒÐ¼Ð¼Ñƒ Ð¾Ñ‡ÐºÐ¾Ð² Ð² Ñ€ÑƒÐºÐµ Ð¸Ð³Ñ€Ð¾ÐºÐ°
        """
        s = 0
        tuz = []
        for i in self.hand:
            if points[i] == 11:
                tuz.append(i)
            s += points[i]
            if s > 21 and tuz:
                tuz.pop(0)
                s -= 10
        return s

class Game():
    """
    ÐšÐ»Ð°ÑÑ Ð´Ð»Ñ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ñ€Ð°Ð·Ð´Ð°Ñ‡Ð¸ Ð² Ð±Ð»ÐµÐºÐ´Ð¶ÐµÐºÐµ, Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ð½ Ð½Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð² Ñ€Ð°Ð¼ÐºÐ°Ñ… 1-Ð¹ Ñ€Ð°Ð·Ð´Ð°Ñ‡Ð¸
    """
    
    def __init__(self, bet: int) -> None:
        """
        ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
            bet: int - Ð¾Ð±Ñ‰Ð°Ñ Ð´Ð»Ñ 1-Ð³Ð¾ ÑÑ‚Ð¾Ð»Ð° ÑÑ‚Ð°Ð²ÐºÐ°
        """
        # Ð¸Ð³Ñ€Ð¾ÐºÐ¸
        self.players = {}
        # ÑÐ»Ð¾Ð²Ð°Ñ€ÑŒ Dict[id: int, List[int]] - Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ ÑÐ¿Ð¸ÑÐ¾Ðº Ð¸Ð· 1-Ð³Ð¾ Ð¸Ð»Ð¸ 2-Ñ… ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð²,
        # ÐµÑÐ»Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð² ÑÐ¿Ð¸ÑÐºÐµ 1, Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ ÐµÑÑ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð¾ Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ, ÐµÑÐ»Ð¸ 0, Ñ‚Ð¾ Ð¾Ð½ ÑƒÐ¶Ðµ ÑÑ‹Ð³Ñ€Ð°Ð»
        # ÐµÑÐ»Ð¸ ÑÐ¿Ð¸ÑÐ¾Ðº Ð¸Ð· 2-Ñ… ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð², Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ Ð¸Ð³Ñ€Ð¾Ðº ÑÐ´ÐµÐ»Ð°Ð» ÑÐ¿Ð»Ð¸Ñ‚ Ð¸ ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ ÐºÐ°Ðº 2 Ð¸Ð³Ñ€Ð¾ÐºÐ°
        self.played = {}
        # Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹, ÑÐµÐ²ÑˆÐ¸Ñ… Ð·Ð° ÑÑ‚Ð¾Ð»
        self.reg = []
        # ÑÑ‚Ð°Ð²ÐºÐ° ÑÑ‚Ð¾Ð»Ð°
        self.bet = bet
        # Ð¿Ð°Ñ‡ÐºÐ° ÑÑ‚Ð¾Ð»Ð°
        self.colode = col.copy()
        # Ð´Ð¸Ð»ÐµÑ€
        self.dealer: Player
    
    async def add_player(self, id: int, name: str, money: int):
        """
        ÐœÐµÑ‚Ð¾Ð´ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð² ÑÐ¿Ð¸ÑÐ¾Ðº ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð² ÑÑ‚Ð¾Ð»Ð°

        ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
            id: int - Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
            name: str - Ð¸Ð¼Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
            money: int - ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð´ÐµÐ½ÐµÐ³ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
        """
        # Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² ÑÐ»Ð¾Ð²Ð°Ñ€ÑŒ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð² ÑÑ‚Ð¾Ð»Ð°
        self.players[id] = [Player(name, self.bet, money, id)]
        # Ð Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð¸Ð³Ñ€Ð¾ÐºÑƒ Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ
        self.played[id] = [1]
        # Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ° Ð·Ð° ÑÑ‚Ð¾Ð»Ð¾Ð¼
        self.reg.append(id)
    
    async def get_card(self):
        """
        ÐœÐµÑ‚Ð¾Ð´ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð¹ ÐºÐ°Ñ€Ñ‚Ñ‹ Ð¸Ð· Ð¿Ð°Ñ‡ÐºÐ¸

        Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚:
            card: int - Ð½Ð¾Ð¼ÐµÑ€ ÐºÐ°Ñ€Ñ‚Ñ‹, ÐºÐ»ÑŽÑ‡ Ðº c, points
        """
        card = choice(self.colode)
        self.colode.remove(card)
        return card
    
    async def give_cards(self, player_id: int, amount: int):
        """
        ÐœÐµÑ‚Ð¾Ð´, Ð²Ñ‹Ð´Ð°ÑŽÑ‰Ð¸Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ Ñ id=player_id amount ÐºÐ°Ñ€Ñ‚

        ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
            player_id: int - Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
            amount: int - ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÐºÐ°Ñ€Ñ‚, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ñ€Ð°Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ
        
        Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚:
            player: Player - Ð¾Ð±ÑŠÐµÐºÑ‚ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»Ñ‘Ð½Ð½Ð¾Ð¹ Ñ€ÑƒÐºÐ¾Ð¹
        """
        index = await self.getCurrPlayerInd(player_id)
        hand = []
        for i in range(amount):
            hand.append(
                await self.get_card()
            )
            self.players[player_id][index].cards -= 1
        hand.extend(self.players[player_id][index].hand)
        await self.change(player_id, index, hand=hand)
        return self.players[player_id][index]
    
    async def getCurrPlayerInd(self, id):
        """
        Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ Ð¸Ð· Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð², Ð¿Ð¾Ð´ id=id, ÐµÑÐ»Ð¸ Ð¸Ð³Ñ€Ð¾Ðº ÑÐ´ÐµÐ»Ð°Ð» ÑÐ¿Ð»Ð¸Ñ‚, Ñ‚Ð¾ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð² Ð·Ð° ÑÑ‚Ð¾Ð»Ð¾Ð¼ Ð¿Ð¾Ð´ 1-Ð¼ id Ð´Ð²Ð¾Ðµ,
        ÑÑ‚Ð¾Ñ‚ Ð¼ÐµÑ‚Ð¾Ð´ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¸Ð½Ð´ÐµÐºÑ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ñ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒÑŽ Ñ…Ð¾Ð´Ð° Ð¸Ð· Ð´Ð²ÑƒÑ…, Ð¸Ð½Ð°Ñ‡Ðµ None
        
        ÐŸÑ€Ð¸Ð¼ÐµÑ€: Ð˜Ð³Ñ€Ð¾Ðº ÑÐ´ÐµÐ»Ð°Ð» ÑÐ¿Ð»Ð¸Ñ‚, Ð¿Ð¾Ñ‚Ð¾Ð¼ hit, Ð¸Ð½Ð´ÐµÐºÑ Ð±ÑƒÐ´ÐµÑ‚ 0-Ð¹, Ð¿Ð¾Ñ‚Ð¾Ð¼ Ð¾Ð½ Ð·Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚ Ñ…Ð¾Ð´,
        Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð´Ð°Ð»ÐµÐµ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ð»Ð¸ÑÑŒ Ñ Ð²Ñ‚Ð¾Ñ€Ñ‹Ð¼ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð¼, Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ñ‘Ð½ 1-Ð¹ Ð¸Ð½Ð´ÐµÐºÑ

        Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚:
            i: int | None - Ð¸Ð½Ð´ÐµÐºÑ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð² ÑÐ¿Ð¸ÑÐºÐµ players, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ
        """
        for i in range(len(self.players[id])):
            if self.players[id][i].end is False:
                return i
        return None
    
    async def create_dealer(self):
        """
        ÐœÐµÑ‚Ð¾Ð´ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð´Ð¸Ð»ÐµÑ€Ð° ÑÑ‚Ð¾Ð»Ð°
        """
        self.dealer = Player(
            "ðŸ‘¤ Ð”Ð¸Ð»ÐµÑ€",
            self.bet,
            99999999999999,
            None
        )
        self.dealer.hand.append(await self.get_card())
        self.dealer.hand.append(await self.get_card())
        
    async def change(self, id: int, index: int, **arg: dict):
        """
        ÐœÐµÑ‚Ð¾Ð´, Ð·Ð°Ð¼ÐµÐ½ÑÑŽÑ‰Ð¸Ð¹ Ð¾Ð±ÑŠÐµÐºÑ‚ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð½Ð° Ð½Ð¾Ð²Ñ‹Ð¹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÑÐ¾Ð·Ð´Ð°Ñ‘Ñ‚ÑÑ Ñ Ð½Ð¾Ð²Ñ‹Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸
        Ð­Ñ‚Ð¾Ñ‚ Ð¼ÐµÑ‚Ð¾Ð´ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð» Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ¸, Ñ‚Ð°Ðº ÐºÐ°Ðº Ð¿Ñ€Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»Ñ Ð¾Ð±ÑŠÐµÐºÑ‚Ð° Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð½Ðµ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ð»Ð¸
        Ð Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚, Ð½Ðµ Ñ‚Ñ€Ð¾Ð³Ð°Ñ‚ÑŒ Ð±ÐµÐ· Ð´Ð¾Ð»Ð¶Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð½Ð¸Ð¼Ð°Ð½Ð¸Ñ

        ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
            id: int - Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
            index: int - Ð¸Ð½Ð´ÐµÐºÑ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð¿Ð¾Ð´ id Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
            args: Dict[str, Any] - ÑÐ»Ð¾Ð²Ð°Ñ€ÑŒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹, Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‰Ð¸Ñ… Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ
        """
        self.players[id][index] = self.players[id][index].from_dict(
            {
                'name': self.players[id][index].name,
                'money': self.players[id][index].money,
                'bet': self.players[id][index].bet,
                'split': self.players[id][index].split,
                'cards': self.players[id][index].cards,
                'end': self.players[id][index].end,
                'hand': self.players[id][index].hand,
                'id': self.players[id][index].id,
                'surrender': self.players[id][index].surrender,
                **arg
            }
        )
        
    async def end_move(self, id: int, s: bool=False):
        """
        ÐœÐµÑ‚Ð¾Ð´, Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÑŽÑ‰Ð¸Ð¹ Ñ…Ð¾Ð´ Ð¸Ð³Ñ€Ð¾ÐºÐ°

        ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
            id: int - Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
            s: bool - ÑÐ´Ð°Ð»ÑÑ Ð»Ð¸ Ð¸Ð³Ñ€Ð¾Ðº
        
        Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚:
            player: Player - Ð¾Ð±ÑŠÐµÐºÑ‚ Ð¸Ð³Ñ€Ð¾ÐºÐ°
        """
        index = await self.getCurrPlayerInd(id)
        self.played[id][index] -= 1
        await self.change(id, index, end=True, surrender=s)
        return self.players[id][index]
    
    async def split(self, id: int):
        """
        ÐœÐµÑ‚Ð¾Ð´, ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸ÑŽ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð¿Ð¾Ð´ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÐµÐ¼ split, Ñ€Ð°Ð·Ð´ÐµÐ»ÑÐµÑ‚ Ñ€ÑƒÐºÑƒ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð¿Ð¾Ñ€Ð¾Ð²Ð½Ñƒ Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ Ð¿Ð¾ 1-Ð¹ Ð½Ð¾Ð²Ð¾Ð¹ ÐºÐ°Ñ€Ñ‚Ðµ ÐºÐ°Ð¶Ð´Ð¾Ð¼Ñƒ
        ÐšÐ°Ð¶Ð´Ð¾Ð¼Ñƒ Ð¸Ð³Ñ€Ð¾ÐºÑƒ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ÑÑ Ð½ÐµÐ·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð°Ñ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¸ Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð² Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ 1 Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ

        ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð½Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð¿Ñ€Ð°Ð²Ð¾ Ð½Ð° split ÑÐ¾Ð³Ð»Ð°ÑÐ½Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼ blackjack, ÑÑ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑ‚ÑÑ Ð²Ð¾Ð²Ð½Ðµ

        ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
            id: int - Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
        
        Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚:
            List[Player] - ÑÐ¿Ð¸ÑÐ¾Ðº Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð² Ð¿Ð¾Ð´ Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
        """
        index = await self.getCurrPlayerInd(id)
        player = self.players[id][index]
        player.split = True

        # Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð² 2-Ðµ
        self.players[id] = [player, player]
        self.played[id] = [1, 1]

        hand1 = [player.hand[0], await self.get_card()]
        hand2 = [player.hand[1], await self.get_card()]
        await self.change(id, 0, hand=hand1)
        await self.change(id, 1, hand=hand2)
        return self.players[id]

    async def double(self, id):
        """
        ÐœÐµÑ‚Ð¾Ð´, ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸ÑŽ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð¿Ð¾Ð´ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÐµÐ¼ double, ÑƒÐ´Ð²Ð°Ð¸Ð²Ð°ÐµÑ‚ ÑÑ‚Ð°Ð²ÐºÑƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ

        ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð½Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð¿Ñ€Ð°Ð²Ð¾ Ð½Ð° double ÑÐ¾Ð³Ð»Ð°ÑÐ½Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼ blackjack, ÑÑ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑ‚ÑÑ Ð²Ð¾Ð²Ð½Ðµ, ÐºÐ¾Ð¼Ð°Ð½Ð´Ð° Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÑ‚ Ñ…Ð¾Ð´ Ð¸Ð³Ñ€Ð¾ÐºÐ°
        Ð¤Ð¸Ð½Ð°Ð½ÑÐ¾Ð²ÑƒÑŽ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð½Ð° ÑƒÐ´Ð²Ð¾ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ð²ÐºÐ¸ Ñ‚Ð°ÐºÐ¶Ðµ ÑÐ»ÐµÐ´ÑƒÐµÑ‚ Ð´ÐµÐ»Ð°Ñ‚ÑŒ Ð²Ð¾Ð²Ð½Ðµ

        ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
            id: int - Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
        
        Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚:
            Player - Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð¸Ð³Ñ€Ð¾Ðº Ð¿Ð¾Ð´ Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
        """
        index = await self.getCurrPlayerInd(id)
        bet = self.players[id][index].bet
        self.players[id][index].bet += bet
        self.players[id][index].money -= bet
        self.players[id][index] = await self.give_cards(id, 1)
        self.players[id][index] = await self.end_move(id)
        return self.players[id][index]

    async def surrender(self, id):
        """
        ÐœÐµÑ‚Ð¾Ð´, ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸ÑŽ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð¿Ð¾Ð´ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÐµÐ¼ surrender, Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑÐ´Ð°Ð»ÑÑ

        ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð½Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð¿Ñ€Ð°Ð²Ð¾ Ð½Ð° surrender ÑÐ¾Ð³Ð»Ð°ÑÐ½Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼ blackjack, ÑÑ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑ‚ÑÑ Ð²Ð¾Ð²Ð½Ðµ, ÐºÐ¾Ð¼Ð°Ð½Ð´Ð° Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÑ‚ Ñ…Ð¾Ð´ Ð¸Ð³Ñ€Ð¾ÐºÐ°

        ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
            id: int - Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
        
        Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚:
            Player - Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð¸Ð³Ñ€Ð¾Ðº Ð¿Ð¾Ð´ Ð°Ð¹Ð´Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
        """
        index = await self.getCurrPlayerInd(id)
        self.players[id][index].money += int(self.players[id][index].bet / 2)
        self.players[id][index] = await self.end_move(id, s=True)
        return self.players[id][index]
    
    async def count_dealer(self):
        """
        ÐœÐµÑ‚Ð¾Ð´ ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ Ð¾Ñ‡ÐºÐ¸ Ð´Ð¸Ð»ÐµÑ€Ð° Ð¸, Ð¿Ð¾ÐºÐ° Ð¸Ñ… Ð¼ÐµÐ½ÐµÐµ 17-Ñ‚Ð¸, Ð´Ð¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ ÐºÐ°Ñ€Ñ‚Ñ‹

        Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚:
            s: int - ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾Ñ‡ÐºÐ¾Ð² Ð´Ð¸Ð»ÐµÑ€Ð°
        """
        s = 0
        tuz = []
        for i in self.dealer.hand:
            if points[i] == 11:
                tuz.append(i)
            s += points[i]
            if s > 21 and tuz:
                tuz.pop(0)
                s -= 10
            
        while s < 17:
            self.dealer.hand.append(await self.get_card())
            s = 0
            tuz = []
            for i in self.dealer.hand:
                if points[i] == 11:
                    tuz.append(i)
                s += points[i]
                if s > 21 and tuz:
                    tuz.pop(0)
                    s -= 10
        return s
